From 61fbe221e04d390f8ed9566d03b1150a837a3300 Mon Sep 17 00:00:00 2001
From: Zifei Tong <zifeitong@gmail.com>
Date: Sat, 16 Aug 2025 17:38:44 -0700
Subject: [PATCH 3/4] Initialize commandline for cronet to prevent crashes

---
 components/cronet/cronet_global_state_stubs.cc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/components/cronet/cronet_global_state_stubs.cc b/components/cronet/cronet_global_state_stubs.cc
index feb6bd5335..51fb907b9d 100644
--- a/components/cronet/cronet_global_state_stubs.cc
+++ b/components/cronet/cronet_global_state_stubs.cc
@@ -7,6 +7,7 @@
 #include <tuple>
 
 #include "base/at_exit.h"
+#include "base/command_line.h"
 #include "base/feature_list.h"
 #include "base/notimplemented.h"
 #include "base/task/sequenced_task_runner.h"
@@ -31,6 +32,8 @@ scoped_refptr<base::SingleThreadTaskRunner> InitializeAndCreateTaskRunner() {
   std::ignore = new base::AtExitManager;
 #endif
 
+  base::CommandLine::Init(0, nullptr);
+
   base::FeatureList::InitInstance(std::string(), std::string());
 
   // Note that in component builds this ThreadPoolInstance will be shared with
-- 
2.51.2

